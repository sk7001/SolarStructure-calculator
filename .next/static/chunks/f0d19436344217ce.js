(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71464,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(22016),r=e.i(72961);async function l(){let{data:e,error:t}=await r.supabase.auth.getUser();if(t)throw t;if(!e?.user?.id)throw Error("Not logged in.");return e.user.id}async function i(){await l();let{data:e,error:t}=await r.supabase.from("pieces").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}async function n(e){let t=await l(),{data:a,error:s}=await r.supabase.from("pieces").insert([{user_id:t,len:Number(e.len),qty:Number(e.qty),note:(e.note??"").trim()}]).select("*").single();if(s)throw s;return a}async function d(e){await l();let{error:t}=await r.supabase.from("pieces").delete().eq("id",e);if(t)throw t;return!0}async function c(){let e=await l(),{error:t}=await r.supabase.from("pieces").delete().eq("user_id",e);if(t)throw t;return!0}let o="w-full h-14 rounded-lg bg-gray-800 text-gray-100 border border-gray-700 px-4 text-base outline-none focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30",u="bg-gray-900 rounded-xl shadow-lg border border-gray-800";function m(){let[e,r]=(0,a.useState)([]),[l,m]=(0,a.useState)(!0),[g,b]=(0,a.useState)(""),[h,y]=(0,a.useState)(""),[x,p]=(0,a.useState)(""),f=async()=>{r(await i())};(0,a.useEffect)(()=>{(async()=>{try{m(!0),await f()}catch(e){alert(e?.message||"Failed to load pieces from cloud.")}finally{m(!1)}})()},[]);let v=(0,a.useMemo)(()=>({lines:e.length,totalQty:e.reduce((e,t)=>e+(Number(t.qty)||0),0)}),[e]),N=async()=>{if(!g||!h)return void alert("Please fill Length and Quantity.");let e=Number(g),t=parseInt(h,10);if(!(e>0)||!(t>0))return void alert("Length and Quantity must be > 0.");try{await n({len:e,qty:t,note:x}),await f(),b(""),y(""),p("")}catch(e){alert(e?.message||"Failed to add piece.")}},j=async e=>{if(confirm("Delete this inventory line?"))try{await d(e),await f()}catch(e){alert(e?.message||"Failed to delete.")}},w=async()=>{if(confirm("Clear ALL usable pieces inventory?"))try{await c(),await f()}catch(e){alert(e?.message||"Failed to clear.")}};return(0,t.jsx)("div",{className:"bg-gray-950 min-h-screen text-gray-100",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Usable Pieces (Inventory)"}),(0,t.jsx)(s.default,{href:"/",className:"rounded-lg bg-gray-800 hover:bg-gray-700 transition-colors px-4 py-2 border border-gray-700",children:"Back"})]}),(0,t.jsxs)("div",{className:`${u} p-6 mt-6`,children:[(0,t.jsxs)("div",{className:"text-gray-300 text-sm",children:["Saved lines: ",(0,t.jsx)("span",{className:"text-gray-100 font-semibold",children:v.lines})," | Total qty:"," ",(0,t.jsx)("span",{className:"text-gray-100 font-semibold",children:v.totalQty})]}),(0,t.jsx)("h2",{className:"text-xl font-semibold mt-4 mb-4",children:"Add usable piece"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-300 mb-2",children:"Length (inches)"}),(0,t.jsx)("input",{type:"number",value:g,onChange:e=>b(e.target.value),className:o})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-300 mb-2",children:"Quantity"}),(0,t.jsx)("input",{type:"number",value:h,onChange:e=>y(e.target.value),className:o})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-gray-300 mb-2",children:"Note (optional)"}),(0,t.jsx)("input",{value:x,onChange:e=>p(e.target.value),className:o})]})]}),(0,t.jsx)("button",{type:"button",onClick:N,className:"mt-4 w-full bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white px-4 py-3 rounded-lg shadow-md transition",children:"Add to inventory (Cloud)"}),(0,t.jsx)("button",{type:"button",onClick:w,className:"mt-3 w-full bg-red-600 hover:bg-red-700 active:bg-red-800 text-white px-4 py-3 rounded-lg shadow-md transition",children:"Clear inventory (Cloud)"})]}),(0,t.jsxs)("div",{className:`${u} p-6 mt-6`,children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Saved usable pieces"}),l?(0,t.jsx)("div",{className:"text-gray-400",children:"Loading..."}):0===e.length?(0,t.jsx)("div",{className:"text-gray-400",children:"No saved pieces."}):(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,t.jsxs)("div",{className:"rounded-xl border border-gray-800 bg-gray-950/40 p-4 flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-gray-100 font-semibold",children:[e.len,'" Ã— ',e.qty]}),e.note?(0,t.jsx)("div",{className:"text-gray-400 text-sm mt-1",children:e.note}):null]}),(0,t.jsx)("button",{type:"button",onClick:()=>j(e.id),className:"shrink-0 rounded-lg bg-gray-800 hover:bg-gray-700 transition-colors px-4 py-2 border border-gray-700",children:"Delete"})]},e.id))})]})]})})}e.s(["default",()=>m],71464)}]);