{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../app/lib/projectsDb.tsx","../../../../app/projects/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","import { supabase } from \"./supabaseClient\";\n\nexport type ProjectRow = {\n  id: string;\n  user_id: string;\n  name: string;\n  inputs: {\n    frontLegHeight: string;\n    numberOfPanels: string;\n    selectedPanelModel: string;\n    isVertical: boolean;\n  };\n  results: any; // your complex results object\n  created_at?: string;\n  updated_at?: string;\n};\n\nasync function requireUserId() {\n  const { data, error } = await supabase.auth.getUser();\n  if (error) throw error;\n  if (!data?.user?.id) throw new Error(\"Not logged in.\");\n  return data.user.id;\n}\n\n// List all projects (for /projects page later)\nexport async function listProjects(): Promise<ProjectRow[]> {\n  await requireUserId();\n\n  const { data, error } = await supabase\n    .from(\"projects\")\n    .select(\"*\")\n    .order(\"created_at\", { ascending: false });\n\n  if (error) throw error;\n  return (data || []) as ProjectRow[];\n}\n\n// Get single project by ID\nexport async function getProjectById(id: string): Promise<ProjectRow> {\n  await requireUserId();\n\n  const { data, error } = await supabase.from(\"projects\").select(\"*\").eq(\"id\", id).single();\n  if (error) throw error;\n  return data as ProjectRow;\n}\n\n// Create new project (your \"Save Project\" button)\nexport async function createProject(input: {\n  name: string;\n  inputs: any;\n  results?: any;\n}): Promise<ProjectRow> {\n  const userId = await requireUserId();\n\n  const { data, error } = await supabase\n    .from(\"projects\")\n    .insert([\n      {\n        user_id: userId,\n        name: input.name.trim(),\n        inputs: input.inputs || {},\n        results: input.results ?? null,\n      },\n    ])\n    .select(\"*\")\n    .single();\n\n  if (error) throw error;\n  return data as ProjectRow;\n}\n\n// Update project (for /projects page editing later)\nexport async function updateProject(\n  id: string,\n  patch: { name: string; inputs?: any; results?: any }\n): Promise<ProjectRow> {\n  await requireUserId();\n\n  const { data, error } = await supabase\n    .from(\"projects\")\n    .update({\n      name: patch.name.trim(),\n      inputs: patch.inputs,\n      results: patch.results ?? null,\n      updated_at: new Date().toISOString(),\n    })\n    .eq(\"id\", id)\n    .select(\"*\")\n    .single();\n\n  if (error) throw error;\n  return data as ProjectRow;\n}\n\n// Delete project\nexport async function deleteProject(id: string) {\n  await requireUserId();\n\n  const { error } = await supabase.from(\"projects\").delete().eq(\"id\", id);\n  if (error) throw error;\n  return true;\n}\n","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { listProjects, deleteProject, type ProjectRow } from \"../lib/projectsDb\";\n\nconst cardClass = \"bg-gray-900 rounded-xl shadow-lg border border-gray-800\";\n\nexport default function ProjectsPage() {\n  const router = useRouter();\n  const [projects, setProjects] = useState<ProjectRow[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  const refresh = async () => {\n    const rows = await listProjects();\n    setProjects(rows);\n  };\n\n  useEffect(() => {\n    (async () => {\n      try {\n        setLoading(true);\n        await refresh();\n      } catch (e: any) {\n        alert(e?.message || \"Failed to load projects from cloud.\");\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, []);\n\n  const hasProjects = projects.length > 0;\n\n  const onDelete = async (id: string) => {\n    const ok = confirm(\"Delete this project?\");\n    if (!ok) return;\n\n    try {\n      await deleteProject(id);\n      await refresh();\n    } catch (e: any) {\n      alert(e?.message || \"Failed to delete project.\");\n    }\n  };\n\n  const onOpen = (id: string) => {\n    // Open in calculator page using query param (cloud-friendly)\n    router.push(`/?projectId=${id}`);\n  };\n\n  return (\n    <div className=\"bg-gray-950 min-h-screen text-gray-100\">\n      <div className=\"max-w-4xl mx-auto p-6\">\n        <div className=\"flex items-center justify-between gap-3\">\n          <h1 className=\"text-2xl font-bold\">Projects</h1>\n\n          <div className=\"flex items-center gap-2\">\n            <Link\n              href=\"/\"\n              className=\"rounded-lg bg-gray-800 hover:bg-gray-700 transition-colors px-4 py-2 border border-gray-700\"\n            >\n              Calculator\n            </Link>\n\n            {hasProjects ? (\n              <Link\n                href=\"/\"\n                className=\"rounded-lg bg-blue-600 hover:bg-blue-700 transition-colors px-4 py-2 border border-blue-500\"\n              >\n                Add Project\n              </Link>\n            ) : null}\n          </div>\n        </div>\n\n        {loading ? (\n          <div className=\"min-h-[70vh] flex items-center justify-center\">\n            <div className={`${cardClass} p-8 w-full max-w-md text-center`}>\n              <div className=\"text-gray-400\">Loading...</div>\n            </div>\n          </div>\n        ) : !hasProjects ? (\n          <div className=\"min-h-[70vh] flex items-center justify-center\">\n            <div className={`${cardClass} p-8 w-full max-w-md text-center`}>\n              <div className=\"text-gray-200 font-semibold text-lg\">No projects yet</div>\n              <div className=\"text-gray-400 text-sm mt-2\">\n                Save a project from the Calculator (bottom button).\n              </div>\n\n              <Link\n                href=\"/\"\n                className=\"mt-6 inline-block w-full bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white px-4 py-3 rounded-lg shadow-md transition\"\n              >\n                Go to Calculator\n              </Link>\n            </div>\n          </div>\n        ) : (\n          <div className={`${cardClass} p-6 mt-6`}>\n            <h2 className=\"text-xl font-semibold mb-4\">Saved projects</h2>\n\n            <div className=\"space-y-3\">\n              {projects.map((p) => (\n                <div\n                  key={p.id}\n                  className=\"rounded-xl border border-gray-800 bg-gray-950/40 p-4 flex items-start justify-between gap-3\"\n                >\n                  <div>\n                    <div className=\"text-gray-100 font-semibold\">{p.name}</div>\n                    <div className=\"text-gray-400 text-sm mt-1\">\n                      Panels: {p.inputs?.numberOfPanels || \"-\"} | Model: {p.inputs?.selectedPanelModel || \"-\"} |{\" \"}\n                      {p.inputs?.isVertical ? \"Vertical\" : \"Horizontal\"}\n                    </div>\n                  </div>\n\n                  <div className=\"shrink-0 flex items-center gap-2\">\n                    <button\n                      type=\"button\"\n                      onClick={() => onOpen(p.id)}\n                      className=\"rounded-lg bg-blue-600 hover:bg-blue-700 transition-colors px-4 py-2 border border-blue-500\"\n                    >\n                      Open\n                    </button>\n\n                    <button\n                      type=\"button\"\n                      onClick={() => onDelete(p.id)}\n                      className=\"rounded-lg bg-red-600 hover:bg-red-700 transition-colors px-4 py-2 border border-red-500\"\n                    >\n                      Delete\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","HooksClientContext","ServerInsertedHtml"],"mappings":"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","ignoreList":[0,1]}